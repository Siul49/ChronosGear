# Phase 0: 프로젝트 셋업

> 기간: 2주 | Unity 프로젝트 기반 구축

---

## 목표
- Unity 프로젝트 생성 및 초기 설정
- 개발 환경 통일
- 핵심 시스템 아키텍처 구축

---

## Week 1: 환경 구축

### Day 1-2: 프로젝트 생성

#### Unity 프로젝트 설정
| 항목 | 설정값 | 비고 |
|------|--------|------|
| Unity 버전 | 2022.3 LTS | 안정성 우선 |
| 템플릿 | 2D (URP) | Universal RP |
| 프로젝트명 | ChronosGear | 영문, 공백 없음 |

#### 초기 패키지 설치
```
// Package Manager에서 설치
- Cinemachine (카메라)
- Timeline (컷신)
- TextMeshPro (UI 텍스트)
- Input System (New Input)
- 2D Sprite (기본)
- 2D Tilemap (맵)
```

#### Player Settings
```
Company Name: [팀명]
Product Name: Chronos Gear
Version: 0.1.0
Default Icon: [임시 아이콘]
Scripting Backend: IL2CPP
API Compatibility: .NET Standard 2.1
```

---

### Day 3-4: Git 저장소

#### 브랜치 전략
```
main (배포용)
  └── develop (개발 통합)
       ├── feature/player-movement
       ├── feature/skill-system
       └── feature/enemy-ai
```

#### .gitignore (Unity용)
```gitignore
# Unity
[Ll]ibrary/
[Tt]emp/
[Oo]bj/
[Bb]uild/
[Bb]uilds/
[Ll]ogs/
[Uu]ser[Ss]ettings/

# Visual Studio
.vs/
*.csproj
*.unityproj
*.sln
*.suo
*.user

# OS
.DS_Store
Thumbs.db

# IDE
.idea/
*.swp
```

#### 커밋 컨벤션
```
feat: 새 기능
fix: 버그 수정
refactor: 리팩토링
docs: 문서
style: 코드 스타일
test: 테스트
chore: 빌드/설정
```

---

### Day 5: 폴더 구조

#### 권장 구조
```
Assets/
├── _Project/                    # 프로젝트 코드
│   ├── Scripts/
│   │   ├── Core/               # 핵심 시스템
│   │   │   ├── GameManager.cs
│   │   │   ├── SceneLoader.cs
│   │   │   ├── EventBus.cs
│   │   │   ├── ObjectPool.cs
│   │   │   └── SaveSystem.cs
│   │   │
│   │   ├── Player/             # 플레이어
│   │   │   ├── PlayerController.cs
│   │   │   ├── PlayerStats.cs
│   │   │   ├── PlayerInput.cs
│   │   │   └── Skills/
│   │   │       ├── ChronoShift.cs
│   │   │       ├── TimeAnchor.cs
│   │   │       ├── Rewind.cs
│   │   │       └── EchoClone.cs
│   │   │
│   │   ├── Enemy/              # 적
│   │   │   ├── EnemyBase.cs
│   │   │   ├── EnemyAI.cs
│   │   │   └── Types/
│   │   │
│   │   ├── Combat/             # 전투
│   │   │   ├── DamageCalculator.cs
│   │   │   ├── Hitbox.cs
│   │   │   ├── Hurtbox.cs
│   │   │   └── StatusEffect.cs
│   │   │
│   │   ├── UI/                 # UI
│   │   │   ├── HUD/
│   │   │   ├── Menu/
│   │   │   └── Dialogue/
│   │   │
│   │   ├── Level/              # 레벨
│   │   │   ├── LevelManager.cs
│   │   │   ├── RoomController.cs
│   │   │   └── Gimmicks/
│   │   │
│   │   └── Data/               # 데이터
│   │       ├── Constants.cs
│   │       └── Enums.cs
│   │
│   ├── ScriptableObjects/      # SO 에셋
│   │   ├── Skills/
│   │   ├── Enemies/
│   │   ├── Items/
│   │   └── Dialogues/
│   │
│   ├── Prefabs/                # 프리팹
│   │   ├── Player/
│   │   ├── Enemies/
│   │   ├── Effects/
│   │   └── UI/
│   │
│   ├── Scenes/                 # 씬
│   │   ├── _Bootstrap.unity    # 초기화 씬
│   │   ├── MainMenu.unity
│   │   ├── Prologue/
│   │   ├── Chapter1/
│   │   └── Chapter2/
│   │
│   └── Resources/              # 동적 로드용
│       └── ...
│
├── Art/                        # 아트 에셋
│   ├── Sprites/
│   │   ├── Characters/
│   │   ├── Enemies/
│   │   ├── Environment/
│   │   └── Effects/
│   ├── Animations/
│   ├── Tilemaps/
│   └── UI/
│
├── Audio/                      # 오디오
│   ├── BGM/
│   ├── SFX/
│   └── Voice/
│
└── Plugins/                    # 외부 플러그인
    └── DOTween/
```

---

## Week 2: 기반 시스템

### Day 1: GameManager

#### GameManager.cs
```csharp
using UnityEngine;

public class GameManager : MonoBehaviour
{
    public static GameManager Instance { get; private set; }
    
    [Header("Game State")]
    public GameState CurrentState = GameState.Playing;
    
    [Header("References")]
    public PlayerController Player;
    
    private void Awake()
    {
        if (Instance == null)
        {
            Instance = this;
            DontDestroyOnLoad(gameObject);
        }
        else
        {
            Destroy(gameObject);
        }
    }
    
    public void PauseGame()
    {
        CurrentState = GameState.Paused;
        Time.timeScale = 0f;
    }
    
    public void ResumeGame()
    {
        CurrentState = GameState.Playing;
        Time.timeScale = 1f;
    }
}

public enum GameState
{
    Playing,
    Paused,
    Dialogue,
    Cutscene,
    Loading
}
```

---

### Day 2: 이벤트 시스템

#### EventBus.cs
```csharp
using System;
using System.Collections.Generic;

public static class EventBus
{
    private static Dictionary<Type, Delegate> _events = new();
    
    public static void Subscribe<T>(Action<T> handler) where T : struct
    {
        var type = typeof(T);
        if (_events.ContainsKey(type))
            _events[type] = Delegate.Combine(_events[type], handler);
        else
            _events[type] = handler;
    }
    
    public static void Unsubscribe<T>(Action<T> handler) where T : struct
    {
        var type = typeof(T);
        if (_events.ContainsKey(type))
            _events[type] = Delegate.Remove(_events[type], handler);
    }
    
    public static void Publish<T>(T evt) where T : struct
    {
        var type = typeof(T);
        if (_events.TryGetValue(type, out var handler))
            ((Action<T>)handler)?.Invoke(evt);
    }
}

// 이벤트 정의 예시
public struct OnPlayerDamaged { public int Damage; public int CurrentHP; }
public struct OnSkillUsed { public string SkillId; public float TPCost; }
public struct OnEnemyDefeated { public string EnemyId; public int ShardsDrop; }
public struct OnAgingChanged { public float OldValue; public float NewValue; }
```

---

### Day 3: 오브젝트 풀

#### ObjectPool.cs
```csharp
using System.Collections.Generic;
using UnityEngine;

public class ObjectPool : MonoBehaviour
{
    public static ObjectPool Instance { get; private set; }
    
    [System.Serializable]
    public class Pool
    {
        public string tag;
        public GameObject prefab;
        public int size;
    }
    
    public List<Pool> pools;
    private Dictionary<string, Queue<GameObject>> _poolDictionary;
    
    private void Awake()
    {
        Instance = this;
        _poolDictionary = new Dictionary<string, Queue<GameObject>>();
        
        foreach (var pool in pools)
        {
            var queue = new Queue<GameObject>();
            for (int i = 0; i < pool.size; i++)
            {
                var obj = Instantiate(pool.prefab);
                obj.SetActive(false);
                queue.Enqueue(obj);
            }
            _poolDictionary.Add(pool.tag, queue);
        }
    }
    
    public GameObject Spawn(string tag, Vector3 position, Quaternion rotation)
    {
        if (!_poolDictionary.ContainsKey(tag)) return null;
        
        var obj = _poolDictionary[tag].Dequeue();
        obj.SetActive(true);
        obj.transform.position = position;
        obj.transform.rotation = rotation;
        
        _poolDictionary[tag].Enqueue(obj);
        return obj;
    }
}
```

---

### Day 4: 씬 로더

#### SceneLoader.cs
```csharp
using System.Collections;
using UnityEngine;
using UnityEngine.SceneManagement;

public class SceneLoader : MonoBehaviour
{
    public static SceneLoader Instance { get; private set; }
    
    [SerializeField] private CanvasGroup fadeCanvas;
    [SerializeField] private float fadeDuration = 0.5f;
    
    private void Awake()
    {
        Instance = this;
    }
    
    public void LoadScene(string sceneName)
    {
        StartCoroutine(LoadSceneRoutine(sceneName));
    }
    
    private IEnumerator LoadSceneRoutine(string sceneName)
    {
        // 페이드 아웃
        yield return StartCoroutine(Fade(1f));
        
        // 씬 로드
        var async = SceneManager.LoadSceneAsync(sceneName);
        while (!async.isDone)
            yield return null;
        
        // 페이드 인
        yield return StartCoroutine(Fade(0f));
    }
    
    private IEnumerator Fade(float target)
    {
        float start = fadeCanvas.alpha;
        float elapsed = 0f;
        
        while (elapsed < fadeDuration)
        {
            elapsed += Time.unscaledDeltaTime;
            fadeCanvas.alpha = Mathf.Lerp(start, target, elapsed / fadeDuration);
            yield return null;
        }
        
        fadeCanvas.alpha = target;
    }
}
```

---

### Day 5: 세이브 시스템

#### SaveSystem.cs
```csharp
using System.IO;
using UnityEngine;

public static class SaveSystem
{
    private static string SavePath => Application.persistentDataPath + "/save.json";
    
    public static void Save(SaveData data)
    {
        string json = JsonUtility.ToJson(data, true);
        File.WriteAllText(SavePath, json);
        Debug.Log($"Saved to: {SavePath}");
    }
    
    public static SaveData Load()
    {
        if (File.Exists(SavePath))
        {
            string json = File.ReadAllText(SavePath);
            return JsonUtility.FromJson<SaveData>(json);
        }
        return new SaveData();
    }
    
    public static bool HasSave() => File.Exists(SavePath);
    public static void DeleteSave() { if (HasSave()) File.Delete(SavePath); }
}

[System.Serializable]
public class SaveData
{
    public string currentScene = "Prologue";
    public int timeShards = 0;
    public int gearPieces = 0;
    public float agingGauge = 0f;
    public int playerHP = 100;
    public int playerTP = 100;
    
    // 스토리 플래그
    public bool[] storyFlags = new bool[100];
    
    // 스킬 업그레이드
    public int shiftLevel = 0;
    public int anchorLevel = 0;
    public int rewindLevel = 0;
    public int echoLevel = 0;
}
```

---

## Phase 0 체크리스트

- [ ] Unity 2022.3 LTS 프로젝트 생성
- [ ] URP 설정 완료
- [ ] New Input System 설정
- [ ] Git 저장소 생성 및 .gitignore 설정
- [ ] 폴더 구조 생성
- [ ] GameManager.cs 구현
- [ ] EventBus.cs 구현
- [ ] ObjectPool.cs 구현
- [ ] SceneLoader.cs 구현
- [ ] SaveSystem.cs 구현
- [ ] Bootstrap 씬 설정

---

## 다음 단계
Phase 0 완료 후 [Phase 1: 코어 메카닉](./14_phase1_core_mechanics.md)으로 진행
