# 던전 & 퍼즐 시스템 (Dungeon & Puzzle System)

> 젤다 스타일 던전 구조와 시간 능력 기반 퍼즐 상세 설계

---

## 왜 이 던전 구조인가? (Design Rationale)

### 열쇠-잠금 시스템 선택 이유

| 이유 | 설명 |
|------|------|
| **명확한 진행감** | "열쇠 찾기 → 문 열기"가 직관적인 목표 제시 |
| **백트래킹 보상** | 새 능력으로 이전 구역 재탐색 = 성장 실감 |
| **비선형 탐험** | 여러 구역 중 선택 가능 → 플레이어 주체성 |
| **시간 스킬 연계** | 각 "열쇠"가 시간 능력과 연결 → 학습 강화 |

### 허브-구역 구조 선택 이유

| 요소 | 왜 이것인가? |
|------|-------------|
| **허브 룸** | 길을 잃어도 안전 지대로 복귀 가능, 스트레스 감소 |
| **숏컷** | 진행 후 허브로 빠르게 돌아오기 = 불필요한 반복 제거 |
| **비선형 경로** | "어디부터 갈까?" 선택의 재미 |

### 퍼즐 보스 선택 이유

| 기존 (패턴 보스) | 퍼즐 보스 | 왜 변경? |
|-----------------|----------|----------|
| HP 깎기 | 약점 발견 | 시간 능력이 **해법**이 됨 |
| 암기/반복 | 관찰/추론 | 더 높은 성취감 |
| 액션 스킬 의존 | 논리력 의존 | 접근성 확대 |

> [!IMPORTANT]
> **핵심 원칙**: 던전은 **퍼즐의 집합**이고, 보스는 **가장 큰 퍼즐**이다.
> 전투력보다 **해법을 발견했는지**가 승패를 결정.

---

## 1. 던전 구조 원칙

### 1.1 열쇠-잠금 시스템

```
던전 진행 = 열쇠 발견 → 잠금 해제 → 새 구역 → 반복
```

| 요소 | 설명 |
|------|------|
| **물리적 열쇠** | 문을 여는 아이템 |
| **능력 열쇠** | 특정 스킬이 있어야 통과 |
| **퍼즐 열쇠** | 퍼즐을 풀어야 해금 |
| **보스 열쇠** | 중간보스 처치 후 획득 |

### 1.2 던전 흐름도

```
[입구] ─────────────────────────────────────────────┐
   │                                                │
   ▼                                                │
┌──────────────┐                                    │
│    허브 룸    │◀───────────────────┐              │
│   (안전지대)  │                    │              │
└──────┬───────┘                    │              │
       │                            │              │
   ┌───┴───┬───────┐               │              │
   │       │       │               │              │
   ▼       ▼       ▼               │              │
┌────┐  ┌────┐  ┌────┐            │  [숏컷]       │
│ A  │  │ B  │  │ C  │            │              │
│열쇠│  │잠금│  │잠금│            │              │
└─┬──┘  └──▲─┘  └──▲─┘            │              │
  │        │       │              │              │
  └────────┘       │              │              │
          [A로 해금]│              │              │
                   │              │              │
              ┌────┴────┐         │              │
              │  B 구역  │─────────┘              │
              │던전아이템│                        │
              └────┬────┘                        │
                   │                             │
              [던전아이템으로 C 해금]              │
                   │                             │
              ┌────▼────┐                        │
              │ 보스 룸  │────────────────────────┘
              └─────────┘
```

---

## 2. 던전별 상세 설계

### 2.1 프롤로그 던전: 다락방

| 항목 | 내용 |
|------|------|
| **목적** | 기본 조작 + 첫 퍼즐 학습 |
| **구조** | 단일 방 + 숨겨진 공간 |
| **핵심 퍼즐** | 기어 슬롯 조합 |

#### 방 구조
```
┌────────────────────────────────────┐
│  [책상]    [시계들]    [문틀]      │
│    ●                    ⌂         │
│                                   │
│  [상자]                  ▣ 기어   │
│    ■                              │
│                                   │
│  [침대]    [거울]    [입구]       │
│    ═        ◇          ↓         │
└────────────────────────────────────┘
```

#### 진행 순서
1. 상자 조사 → 작은 기어 발견
2. 문틀 슬롯에 기어 장착
3. 문이 열리지 않음 → 더 큰 기어 필요
4. 거울 조사 → 숨겨진 캐비닛 발견
5. 캐비닛에서 중형 기어 획득
6. 올바른 조합으로 문 열기

---

### 2.2 1장 던전: 쇠락의 정원

| 항목 | 내용 |
|------|------|
| **목적** | 크로노 시프트 마스터 |
| **구조** | 3층 + 허브 |
| **핵심 퍼즐** | 거리 퍼즐, 타이밍 발판 |

#### 던전 맵
```
[3층: 보스룸]
    ▲
    │ (레버 활성화 필요)
    │
[2층: 타이밍 구역]──[숨겨진 방]
    ▲
    │ (열쇠 필요)
    │
[1층: 거리 퍼즐]──[허브]──[열쇠 방]
```

#### 퍼즐 상세

**1층: 거리 퍼즐**
```
[시작]                           [목표 발판]
   ○ ─────── 4유닛 ─────────────── □

   해법: 시프트 2회 (2+2 = 4유닛)
```

**2층: 타이밍 발판**
```
[발판 A]    [발판 B]    [발판 C]    [목표]
   ○          ↑          ↑          □
   │         (2초마다    (3초마다
   │          출현)       출현)
   │
   └─── 시프트로 타이밍 맞춰 이동
```

**보스: 시간 먹는 자 (퍼즐 버전)**
- Phase 1: 빠르게 이동 → **시프트로 추적**
- Phase 2: 투사체 발사 → **시프트로 회피 + 반격**
- Phase 3: 분열 → **정확한 시프트로 본체 파악**

---

### 2.3 2장 던전: 기억의 연구소

| 항목 | 내용 |
|------|------|
| **목적** | 타임 앵커 + 리와인드 학습 |
| **구조** | 비선형 미로 |
| **핵심 퍼즐** | 동기화, 복원 |

#### 핵심 메카닉: 과거/현재 레이어
```
[현재의 방]                [과거의 방]
┌──────────────┐          ┌──────────────┐
│  ×  파괴된   │   리와   │  ═══════════ │
│     다리     │ ◀─인드─▶ │  온전한 다리 │
│              │          │              │
└──────────────┘          └──────────────┘
```

#### 퍼즐 상세

**동기화 퍼즐**
```
[기어 A] ────○────○────○──── (속도: 빠름)
[기어 B] ────────○───────── (속도: 느림)

문제: 두 기어가 동시에 맞물려야 문 열림
해법: 앵커로 기어 A 감속 → 동기화 성공
```

**복원 연쇄 퍼즐**
```
[1] 부서진 레버  ──리와인드──▶  [1] 작동 레버
         │
         ▼
[2] 발판 활성화
         │
         ▼
[3] 문 열림 (30초 제한)
         │
         ▼
[4] 무너진 다리  ──리와인드──▶  건너기
```

---

### 2.4 3장 던전: 대시계 내부

| 항목 | 내용 |
|------|------|
| **목적** | 에코 클론 마스터 + 종합 |
| **구조** | 대형 퍼즐 복합체 |
| **핵심 퍼즐** | 분신 협력, 시간 분기 |

#### 핵심 메카닉: 클론 협력
```
[동시 발판 퍼즐]
       ┌─────────────────┐
       │       문 🚪      │
       └────────▲────────┘
                │
        ┌───────┴───────┐
        │               │
     [발판 A]        [발판 B]
        ↑               ↑
      클론 ○          플레이어 ●
```

#### 대형 퍼즐: 시계탑 기어

```
           [최종 기어]
              ⚙
             /│\
            / │ \
           /  │  \
         ⚙   ⚙   ⚙    ← 3개의 중간 기어
         ↑   ↑   ↑
       [A] [B] [C]    ← 각각 다른 방에서 활성화
         │   │   │
         └───┼───┘
             │
         [허브 룸]

각 기어 활성화:
- A: 거리 퍼즐 (시프트)
- B: 동기화 퍼즐 (앵커)
- C: 분신 퍼즐 (클론)
```

---

## 3. 퍼즐 카탈로그

### 3.1 거리/이동 퍼즐

| ID | 이름 | 해법 | 난이도 |
|----|------|------|--------|
| P001 | 단순 갭 | 시프트 1회 | ★ |
| P002 | 연속 갭 | 시프트 2-3회 | ★★ |
| P003 | 레이저 그리드 | 시프트 + 타이밍 | ★★★ |
| P004 | 움직이는 발판 | 시프트 + 판단 | ★★★★ |

### 3.2 시간 조작 퍼즐

| ID | 이름 | 해법 | 난이도 |
|----|------|------|--------|
| P101 | 빠른 기어 | 앵커로 감속 | ★ |
| P102 | 동기화 | 앵커 + 타이밍 | ★★★ |
| P103 | 부서진 다리 | 리와인드 | ★ |
| P104 | 연쇄 복원 | 리와인드 연속 | ★★★ |
| P105 | 투사체 반사 | 리와인드 타이밍 | ★★★★ |

### 3.3 분신 퍼즐

| ID | 이름 | 해법 | 난이도 |
|----|------|------|--------|
| P201 | 동시 스위치 | 클론 + 발판 | ★★ |
| P202 | 레버 유지 | 클론이 잡고 있는 동안 | ★★ |
| P203 | 경로 분담 | 클론이 다른 경로 | ★★★★ |
| P204 | 시간차 공격 | 클론과 협공 | ★★★ |

### 3.4 복합 퍼즐

| ID | 이름 | 필요 스킬 | 난이도 |
|----|------|-----------|--------|
| P301 | 시간 미로 | 시프트 + 앵커 | ★★★ |
| P302 | 복원 레이스 | 리와인드 + 시프트 | ★★★★ |
| P303 | 삼중 스위치 | 클론 + 앵커 + 시프트 | ★★★★★ |

---

## 4. 환경 기믹

### 4.1 기본 기믹

| 기믹 | 작동 방식 | 스킬 상호작용 |
|------|-----------|---------------|
| 압력 발판 | 밟으면 활성화 | 클론이 대신 밟을 수 있음 |
| 레버 | 당기면 발동, 시간 제한 | 앵커로 시간 연장 |
| 부서진 오브젝트 | 통과 불가 | 리와인드로 복원 |
| 이동 발판 | 주기적 이동 | 앵커로 속도 조절 |
| 레이저 그리드 | 접촉 시 데미지 | 시프트로 통과 |

### 4.2 시간 관련 기믹

| 기믹 | 효과 | 해제 방법 |
|------|------|-----------|
| 시간 정지 구역 | 진입 시 정지 | 리와인드 |
| 시간 가속 구역 | 이동 속도 3배 | 앵커 |
| 시간 역전 구역 | 조작 반전 | - (적응) |
| 과거의 문 | 과거 버전으로 이동 | 특정 기어 |

---

## 5. 보스 퍼즐 상세

### 5.1 보스 공통 구조

```
[무적 상태] ──[약점 노출]──▶ [피해 기회] ──[회복]──▶ 반복
     │
     └── 퍼즐로 약점 노출시킴
```

### 5.2 챕터별 퍼즐 보스

#### 1장: 시간 먹는 자
| 페이즈 | 보스 행동 | 퍼즐 해법 |
|--------|----------|----------|
| 1 | 빠른 이동, 접근 불가 | 앵커로 감속 → 공격 |
| 2 | 투사체 폭격 | 리와인드로 반사 |
| 3 | 분열 후 혼란 | 클론으로 양쪽 견제 |

#### 2장: 벨로 (퍼즐 형태)
| 페이즈 | 보스 행동 | 퍼즐 해법 |
|--------|----------|----------|
| 1 | 실험실 기계 조작 | 기계 파괴 (앵커 + 공격) |
| 2 | 시간 왜곡 필드 | 리와인드로 안정화 |
| 3 | 도주 | 클론으로 경로 차단 |

#### 3장: 영원의 수호자
| 페이즈 | 보스 행동 | 퍼즐 해법 |
|--------|----------|----------|
| 1 | 기어 보호막 | 3개 기어 동시 파괴 (클론) |
| 2 | 시간 역전 공격 | 리와인드로 카운터 |
| 3 | 환경 조작 | 모든 스킬 종합 |

#### 4장: 모라 (최종)
| 페이즈 | 보스 행동 | 퍼즐 해법 |
|--------|----------|----------|
| 1 | 원거리 저격 | 시프트로 접근 |
| 2 | 시간 감옥 | 앵커로 감속 + 탈출 |
| 3 | 시간 정지 선언 | 리와인드 + 클론 총동원 |
